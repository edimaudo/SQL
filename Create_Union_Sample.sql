CREATE TABLE EDWPRDBW..PRODVIEW AS 
(
WITH TY AS
(
SELECT
CD.C445_YR_NUM,
CD.C445_WK_NUM,
PV.PROD_NUM,
SUM(PV.VIEWS) AS SKU_VIEWS

FROM
EDWPRDBW..PRODVIEWS PV,
EDWPRD..CALENDAR_DIM CD

WHERE
CD.DAY_DATE = PV.VIEW_DATE AND
CD.C445_YR_NUM = 2015 AND
CD.C445_WK_NUM BETWEEN 1 AND 8

GROUP BY
CD.C445_YR_NUM,
CD.C445_WK_NUM,
PV.PROD_NUM
)
,

PY AS
(
SELECT
CD.C445_YR_NUM,
(CD.C445_WK_NUM - 1) AS WK_NUM,
PV.SKU,
SUM(PV.PROD_VIEWS) AS SKU_VIEWS

FROM
EDWPRDBW..DAILY_PRODVIEWS PV,
EDWPRD..CALENDAR_DIM CD

WHERE
CD.DAY_DATE = PV.DAY_DATE AND
CD.C445_YR_NUM = 2014 AND
CD.C445_WK_NUM BETWEEN 2 AND 9

GROUP BY
CD.C445_YR_NUM,
WK_NUM,
PV.SKU
)

SELECT
* 
FROM TY

UNION ALL

SELECT
* 
FROM PY
)